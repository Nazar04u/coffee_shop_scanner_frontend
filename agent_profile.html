<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200;300;400&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/7d2e76b057.js" crossorigin="anonymous"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/charts.css/dist/charts.min.css">
    <link rel="stylesheet" href="css/style.css">
    <title>Profile</title>
</head>
<body class="profile">
    <header>
        <div class="row align-items-start">
            <h1 class="col name">CoffeeShop_Assistant</h1>
            <div class="col" >
                <nav class="row align-items-start">
                    <a class="col dissapear_768" id="conditionalLink" href="#">Guide</a>
                    <a class="col" href="app.html">APP</a>
                    <a class="col" href="work.html">Work</a>
                    <a class="col dissapear_768" href="contact.html">Contact</a>
                    <a class="col" href="sign_up.html">Sign up or Login</a>
                </nav>
            </div>
        </div>
    </header>
    <div class="container">
        <div class="row">
            <div class="col-5">
                <img class="avatar"src="img/Default_pfp.svg.png" alt="user_photo">
                <h3>John Doe</h3>
                <p>Real estate agent</p>
                <p><i class="fa-solid fa-location-dot"></i> New York, USA</p>
                <div class="row dissapear_768">
                    <div class="col-3">
                        <h4>32</h4>
                        <p>Closed deals</p>
                    </div>
                    <div class="col-3">
                        <h4>4</h4>
                        <p>Opened deals</p>
                    </div>
                    <div class="col-6">
                        <h4>74 days</h4>
                        <p>Avarage duration of a deal</p>
                    </div>
                </div>
                <div class="row interaction">
                    <a class="edit_profile col">Edit</a>
                    <a class="send_message col">Send message</a>
                </div>
            </div>
            <div class="col-7 row stats" id="stats">
                <div class="chart-container col-6">
                    <canvas id="myPieChart"></canvas>
                </div>
                <div class="chart-container col-6">
                    <canvas id="Satisfaction_rate"></canvas>
                </div>
            </div>
            <div class="row deals">
                <h2>Open deals</h2>
                <div class="card-group">
                    <div class="card" style="width: 18rem;">
                        <img src="img/property_photo_1.svg" class="card-img-top" alt="...">
                        <div class="card-body">
                          <h5 class="card-title">Card title</h5>
                          <p class="card-text dissapear_768">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                          <a href="results_detail.html" class="btn btn-primary">Learn more</a>
                        </div>
                    </div>
                    <div class="card" style="width: 18rem;">
                        <img src="img/property_photo_2.svg" class="card-img-top" alt="...">
                        <div class="card-body">
                          <h5 class="card-title">Card title</h5>
                          <p class="card-text dissapear_768">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                          <a href="results_detail.html" class="btn btn-primary">Learn more</a>
                        </div>
                    </div>
                    <div class="card" style="width: 18rem;">
                        <img src="img/property_photo_3.svg" class="card-img-top" alt="...">
                        <div class="card-body">
                          <h5 class="card-title">Card title</h5>
                          <p class="card-text dissapear_768">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
                          <a href="results_detail.html" class="btn btn-primary">Learn more</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const ctx = document.getElementById('myPieChart').getContext('2d');

            let currentValue = 77;
            let i = 0;
            const data = {
                labels: ['Completed', 'Remaining'],
                datasets: [{
                    data: [currentValue, 100 - currentValue],
                    backgroundColor: ['#2FF9FF', '#ecf0f1'],
                }]
            };
        
            const options = {
                responsive: true,
                maintainAspectRatio: true,
                animation: {
                    animateRotate: true,
                    onProgress: function (animation) {
                        // Update the title text during the animation
                        const progress = animation.currentStep / animation.numSteps;
                        Value = Math.ceil(progress * currentValue);
                        if (Value != currentValue & i >= 1400) {
                            Value = currentValue;
                        }
                        i++;
                        myPieChart.options.plugins.title.text = Value + '%';
                    },
                    onComplete: function (animation) {
                        // Set the final value after animation completes
                        myPieChart.options.plugins.title.text = currentValue + '%';
                        i = 1400;
                    },
                    duration: 7000,
                    numSteps: 1400,
                },
                cutout: "85%",
                plugins: {
                    title: {
                        text: currentValue.toFixed(0) + '%',
                        color: '#2FF9FF',
                        font: {
                            size: window.innerWidth*0.015,
                            weight: 'bold'
                        },
                    },
                    legend:{
                        display: true,
                        labels:{
                            font: {
                                size: window.innerWidth*0.015,
                                weight: 500
                            }
                        }
                    }
                },

            };
        
            const myPieChart = new Chart(ctx, {
                type: 'doughnut',
                data: data,
                options: options,
                plugins: [{
                    beforeDraw: function (chart) {
                        const ctx = chart.ctx;
                        const width = chart.width;
                        const height = chart.height;
                    
                        ctx.restore();
                        const fontSize = (height / 100).toFixed(2);
                        ctx.font = fontSize + "em Arial";
                        ctx.fillStyle = chart.options.plugins.title.color || '#000';
                        ctx.textBaseline = "middle";
                        const text = chart.options.plugins.title.text;
                        const textWidth = ctx.measureText(text).width;
                        // Calculate position based on canvas size
                        const textX = (width / 2 - textWidth / 2)*1.075;
                        let textY = height / 2 *1.2;
                        if (window.innerWidth <= 1400){
                            textY = height/2*1.2
                        }
                        if (window.innerWidth <= 1200){
                            textY = height/2*1.2
                        }
                        if (window.innerWidth <= 992){
                            textY = height/2*1.23
                        }
                        if (window.innerWidth <= 768){
                            textY = height/2*1.35;
                        }
                        if (window.innerWidth <= 576){
                            textY = height/2*1.425;
                        }
                        ctx.fillText(text, textX, textY);
                        ctx.save();
                    }
                }]
            });
        });
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const ctx = document.getElementById('Satisfaction_rate').getContext('2d');

            let currentValue = 91;
            let i = 0;
            const data = {
                labels: ['Satisfied', 'Unsatisfied'],
                datasets: [{
                    data: [currentValue, 100 - currentValue],
                    backgroundColor: ['#FF8000', '#ecf0f1'],
                }]
            };
        
            const options = {
                responsive: true,
                maintainAspectRatio: true,
                animation: {
                    animateRotate: true,
                    onProgress: function (animation) {
                        // Update the title text during the animation
                        const progress = animation.currentStep / animation.numSteps;
                        Value = Math.ceil(progress * currentValue);
                        if (Value != currentValue & i >= 1400) {
                            Value = currentValue;
                        }
                        i++;
                        myPieChart.options.plugins.title.text = Value + '%';
                    },
                    onComplete: function (animation) {
                        // Set the final value after animation completes
                        myPieChart.options.plugins.title.text = currentValue + '%';
                        i = 1400;
                    },
                    duration: 7000,
                    numSteps: 1400,
                },
                cutout: "85%",
                plugins: {
                    title: {
                        text: currentValue.toFixed(0) + '%',
                        color: '#FF8000',
                        font: {
                            size: '1.5vw',
                            weight: 'bold'
                        },
                    },
                    legend:{
                        display: true,
                        labels:{
                            font: {
                                size: window.innerWidth*0.015,
                                weight: 500
                            }
                        }
                    }
                },

            };
        
            const myPieChart = new Chart(ctx, {
                type: 'doughnut',
                data: data,
                options: options,
                plugins: [{
                    beforeDraw: function (chart) {
                        const ctx = chart.ctx;
                        const width = chart.width;
                        const height = chart.height;
                    
                        ctx.restore();
                        const fontSize = (height / 100).toFixed(2);
                        ctx.font = fontSize + "em Arial";
                        ctx.fillStyle = chart.options.plugins.title.color || '#000';
                        ctx.textBaseline = "middle";
                        const text = chart.options.plugins.title.text;
                        const textWidth = ctx.measureText(text).width;
                        // Calculate position based on canvas size
                        const textX = (width / 2 - textWidth / 2)*1.075;
                        let textY = height / 2 *1.1;
                        if (window.innerWidth <= 1400){
                            textY = height/2*1.15
                        }
                        if (window.innerWidth <= 1200){
                            textY = height/2*1.2
                        }
                        if (window.innerWidth <= 992){
                            textY = height/2*1.23
                        }
                        if (window.innerWidth <= 768){
                            textY = height/2*1.35;
                        }
                        if (window.innerWidth <= 576){
                            textY = height/2*1.425;
                        }
                        ctx.fillText(text, textX, textY);
                        ctx.save();
                    }
                }]
            });
        });
    </script>
    <script>
        // Function to handle the link click based on screen width
        function handleLinkClick(event) {
            // Prevent the default behavior of the link
            event.preventDefault();
    
            // Check the screen width
            var screenWidth = window.innerWidth
    
            // Redirect to the appropriate page based on the screen width
            if (screenWidth <= 767) {
                window.location.href = 'guide.html'; // Replace with the actual mobile page URL
            } else {
                window.location.href = 'guide2.html'; // Replace with the actual desktop page URL
            }
        }
    
        // Add a click event listener to the link
        document.getElementById('conditionalLink').addEventListener('click', handleLinkClick);
        document.getElementById('conditionalLink2').addEventListener('click', handleLinkClick)
    </script>
</body>
</html>